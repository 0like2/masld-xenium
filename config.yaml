# ============================================================================
# Xenium λ¶„μ„ νμ΄ν”„λΌμΈ μ„¤μ • νμΌ
# ============================================================================

# ============================================================================
# 1οΈβƒ£ λ°μ΄ν„° κ²½λ΅ μ„¤μ • (ν•„μ!)
# ============================================================================

data:
  # Xenium λ°μ΄ν„° κ²½λ΅ (h5ad νμΌ λλ” μ›λ³Έ λ””λ ‰ν† λ¦¬)
  # h5ad νμΌ μ‚¬μ© (κ¶μ¥, λΉ λ¦„):
  #   - ./data/unprocessed_adata/ms_brain_rep1.h5ad
  #   - ./data/unprocessed_adata/h_breast_1.h5ad
  xenium_input_path: "./data/unprocessed_adata/human_brain.h5ad"

  # κ²°κ³Ό μ €μ¥ν•  λ””λ ‰ν† λ¦¬
  # μ΄ λ””λ ‰ν† λ¦¬κ°€ μ—†μΌλ©΄ μλ™ μƒμ„±λ¨
  output_path: "./output"

  # μƒν” μ΄λ¦„ (μƒμ„±λλ” νμΌμ prefixλ΅ μ‚¬μ©)
  sample_tag: "human_brain"


# ============================================================================
# 2οΈβƒ£ νμ΄ν”„λΌμΈ μ‹¤ν–‰ λ‹¨κ³„ μ„¤μ •
# ============================================================================
pipeline:
  # μ‹¤ν–‰ν•  λ‹¨κ³„ μ§€μ •
  # ν•„μ: [0, 1, 6]  (~30λ¶„)
  # κ¶μ¥: [0, 1, 2, 4, 6]  (~1μ‹κ°„, μ‹¬ν™” λ¶„μ„ ν¬ν•¨)
  # μ „μ²΄: [0, 1, 2, 3, 4, 5, 6]  (~2μ‹κ°„, λ¨λ“  λ¶„μ„)
  steps:
    - 0  # Step 0: λ°μ΄ν„° ν¬λ§·ν…
    - 1  # Step 1: μ „μ²λ¦¬
    - 6  # Step 6: μ „μ²λ¦¬ μµμ ν™”
    # - 2  # Step 2: μ„Έν¬μ§-ν•µ λ¶„μ„ (μ„ νƒ)
    # - 4  # Step 4: μµμ  κ±°λ¦¬ (μ„ νƒ)
    # - 5  # Step 5: λ¶„ν•  λ²¤μΉλ§ν¬ (μ„ νƒ)
    # - 3  # Step 3: ν”λ«νΌ λΉ„κµ (μ„ νƒ)


# ============================================================================
# 3οΈβƒ£ μ „μ²λ¦¬ νλΌλ―Έν„° (Step 1)
# ============================================================================
preprocessing:
  # μ •κ·ν™” κΈ°μ¤€κ°’
  # κ¶μ¥: 100 (λ…Όλ¬Έμ—μ„ κ²€μ¦λ¨, 618κ°€μ§€ μ΅°ν•© μ¤‘ μµμ )
  # μ„ νƒμ§€: 100, None
  target_sum: 100

  # μµμ† μΉ΄μ΄νΈ ν•„ν„°
  # μ„Έν¬λ‹Ή μµμ† μΉ΄μ΄νΈ μ (λ„λ¬΄ λ‚®μΌλ©΄ λ…Έμ΄μ¦ μ¦κ°€)
  mincounts: 10

  # μµμ† μ μ „μ ν•„ν„°
  # μ„Έν¬λ‹Ή μµμ† μ μ „μ λ°ν„ μ
  mingenes: 3

  # μµκ·Όμ ‘ μ΄μ›ƒ μ (KNN)
  neigh: 15

  # ν‘μ¤€ν™” (Scaling)
  # β“ False κ¶μ¥: κ³µκ°„ λ°μ΄ν„°μ—μ„ ν‘μ¤€ν™”ν•λ©΄ μ‹ νΈ μ†μ‹¤
  # μ„ νƒμ§€: True, False
  scale: False

  # κ³ λ³€μ΄ μ μ „μ μ„ νƒ
  # β“ False κ¶μ¥: λ¨λ“  μ μ „μ μ‚¬μ©μ΄ λ” μ •ν™• (μ €λ°ν„ μ μ „μλ„ κ³µκ°„ ν¨ν„΄ μ •λ³΄ ν¬ν•¨)
  # μ„ νƒμ§€: True, False
  hvg: False


# ============================================================================
# 4οΈβƒ£ Stepλ³„ νλΌλ―Έν„°
# ============================================================================
step_parameters:

  # Step 2: μ„Έν¬μ§-ν•µ λ¶„μ„
  step2:
    # λ°μ΄ν„° μƒν”λ§ λΉ„μ¨ (λ©”λ¨λ¦¬ ν¨μ¨)
    # - 1.0: μ „μ²΄ μ‚¬μ© (κ°€μ¥ μ •ν™•ν•μ§€λ§ λλ¦Ό)
    # - 0.1: 10% μƒν”λ§ (κ¶μ¥, λΉ λ¥΄κ³  μ¶©λ¶„ν•¨)
    # - 0.05: 5% μƒν”λ§ (λ§¤μ° λΉ λ¦„)
    sample_fraction: 0.1

  # Step 4: μµμ  ν™•μ¥ κ±°λ¦¬
  step4:
    # κ±°λ¦¬ λ²”μ„ (Βµm)
    # - min_distance: μµμ† κ±°λ¦¬
    # - max_distance: μµλ€ κ±°λ¦¬
    min_distance: 5
    max_distance: 20

  # Step 6: μ „μ²λ¦¬ μ‹λ®¬λ μ΄μ…
  step6:
    # λ°μ΄ν„° μƒν”λ§ λΉ„μ¨ (λ©”λ¨λ¦¬ ν¨μ¨)
    # - 0.1: 10% μƒν” (μ •ν™•ν•¨, 30λ¶„)
    # - 0.05: 5% μƒν” (κ¶μ¥, 15λ¶„)
    # - 0.02: 2% μƒν” (λΉ λ¦„, 5λ¶„)
    sample_size: 0.05


# ============================================================================
# 5οΈβƒ£ λ΅κΉ… λ° μ¶λ ¥ μ„¤μ •
# ============================================================================
logging:
  # λ΅κ·Έ λ λ²¨
  # - DEBUG: λ¨λ“  μ •λ³΄ (λ§¤μ° μƒμ„Έ)
  # - INFO: μ§„ν–‰ μƒν™© + κ²°κ³Ό (κ¶μ¥)
  # - WARNING: κ²½κ³  + μ—λ¬λ§
  # - ERROR: μ—λ¬λ§
  level: "INFO"

  # μ§„ν–‰ μƒν™© ν‘μ‹
  verbose: True

  # λ΅κ·Έ νμΌ μ €μ¥
  save_log: True
  log_file: "xenium_pipeline.log"


# ============================================================================
# 6οΈβƒ£ λ©”λ¨λ¦¬ λ° μ„±λ¥ μ„¤μ •
# ============================================================================
performance:
  # μµλ€ λ©”λ¨λ¦¬ μ‚¬μ©λ‰ (GB, μ„ νƒμ‚¬ν•­)
  # 0 = μ ν• μ—†μ (κΈ°λ³Έ)
  max_memory_gb: 0

  # λ³‘λ ¬ μ²λ¦¬ μ¤λ λ“ μ
  # 0 = μλ™ κ°μ§€ (κ¶μ¥)
  n_jobs: 0

  # ν° λ°°μ—΄μ„ μ„ν•΄ λ©”λ¨λ¦¬ λ§¤ν•‘ μ‚¬μ©
  use_memory_mapping: False


# ============================================================================
# 7οΈβƒ£ Xenium ν¬λ§· μ„ νƒ
# ============================================================================
# λ‹Ήμ‹ μ Xenium λ°μ΄ν„° λ²„μ „μ„ μ„ νƒν•μ„Έμ”
xenium_format:
  # Xenium μ¶λ ¥ ν¬λ§· λ²„μ „
  # - "2024": ν„μ¬ Xenium ν¬λ§· (κ¶μ¥, mid-2023 μ΄μƒ)
  # - "2023": 2023 μ΄λ° Xenium ν¬λ§·
  # - "2022": 2022 Xenium ν¬λ§· (κµ¬ν•)
  version: "2024"

  # μλ™ ν¬λ§· κ°μ§€ (λ―Έμ§€μ›, μλ™μΌλ΅ μ„ νƒ)
  auto_detect: False


# ============================================================================
# 8οΈβƒ£ κ³ κΈ‰ μ„¤μ • (μΌλ°μ μΌλ΅ μμ •ν•μ§€ μ•μ)
# ============================================================================
advanced:
  # PCA μ„±λ¶„ μ (μ „μ²λ¦¬)
  # 0 = μ „μ²΄ μ‚¬μ© (κ¶μ¥)
  n_pcs: 0

  # ν΄λ¬μ¤ν„°λ§ ν•΄μƒλ„ (resolution)
  # λ†’μ„μλ΅ ν΄λ¬μ¤ν„° λ§μ
  leiden_resolution: 1.4
  louvain_resolution: 1.4

  # λ©ν‘ ν΄λ¬μ¤ν„° μ
  target_clusters: 30

  # μ¤νμ¤ ν–‰λ ¬ μ‚¬μ© (λ©”λ¨λ¦¬ μ μ•½)
  use_sparse_matrix: True


# ============================================================================
# π― λΉ λ¥Έ μ°Έκ³ 
# ============================================================================
#
# 1. ν•„μ μμ • (μ²μ μ‚¬μ©μ):
#    - xenium_input_path: λ‹Ήμ‹ μ Xenium λ°μ΄ν„° κ²½λ΅
#    - sample_tag: μƒν” μ΄λ¦„
#
# 2. μ‹¤ν–‰:
#    python xenium_pipeline_main.py
#
# 3. κ²°κ³Ό:
#    output/
#    β”β”€β”€ {sample_tag}_step0_formatted.h5ad
#    β”β”€β”€ {sample_tag}_step1_preprocessed.h5ad
#    β””β”€β”€ {sample_tag}_step6_ari_scores.csv
#
# 4. μµμ…:
#    - λΉ λ¥Έ λ¶„μ„: steps = [0, 1]
#    - ν‘μ¤€ λ¶„μ„: steps = [0, 1, 6]
#    - μ™„μ „ λ¶„μ„: steps = [0, 1, 2, 4, 6]
#
# ============================================================================
